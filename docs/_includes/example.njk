{% from 'macros.njk' import bubble %}
{% set resize_handler %}this.style.height = this.contentDocument.documentElement.offsetHeight + 'px'{% endset %}
{% set standalone = meta.standalone !== 'false' %}
<div class="my-20 border-1 border-solid border-slate-4">
  <div class="{{ meta.wrapper_class | default('p-20') }}">
    <iframe
      class="w-full border-0 bg-white"
      onload="{{ resize_handler }}"
      onresize="{{ resize_handler }}"
      scrolling="no"
      style="overflow-y: auto;"
      {% if standalone %}
        src="{{ url }}"
      {% else %}
        srcdoc="{{ code | e }}"
      {% endif %}
    ></iframe>
  </div>
  <div class="bg-grey-1 border-0 border-t-2 border-solid border-slate-4 relative">
    <details class="details-reset p-20">
      <summary class="flex gap-8 justify-start align-middle">
        <div class="small font-medium mt-2">
          Code sample
        </div>
        <sfgov-icon symbol="chevron-right" class="open:hidden"></sfgov-icon>
        <sfgov-icon symbol="chevron-down" class="hidden open:inline-flex"></sfgov-icon>
      </summary>
      <div class="mt-16 flex-auto" id="{{ id }}">
        {{ content | safe }}
      </div>
    </details>
    <div class="absolute top-20 right-20 flex justify-end gap-8">
      {% set button_class = 'btn btn-inverse rounded-4 px-8 py-4 hocus:bg-slate-4 hocus:text-white' %}
      {% if codepen %}
        <form
          class="block"
          action="https://codepen.io/pen/define/"
          method="POST"
          target="_blank"
        >
          <input
            name="data"
            type="hidden"
            value="{{ codepen | dump(2) | e }}"
          >
          <button
            type="submit"
            aria-label="Edit in CodePen"
            class="{{ button_class }} group relative"
          >
            <sfgov-icon symbol="code"></sfgov-icon>
            {{ bubble('Edit in CodePen') }}
          </button>
        </form>
      {% endif %}

      <clipboard-copy for="{{ id }}" class="block">
        <button
          aria-label="Copy code"
          class="{{ button_class }} group relative"
        >
          <sfgov-icon symbol="clipboard"></sfgov-icon>
          {{ bubble('Copy code') }}
        </button>
      </clipboard-copy>
    </div>
  </div>
</div>
