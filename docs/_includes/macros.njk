{% macro nav_link(url, deep=true) %}
  {% set node = url | node(collections.all) %}
  {% set children = node.data.page | children(collections.all) %}
  <div class="mb-20">
    <a
      class="flex justify-center title-xs no-underline mb-20"
      href="{{ url }}"
      {% if node.data.page.url === page.url %}
        aria-current="page"
      {% endif %}
    >
      <div class="flex-auto">{{ node.data.title }}</div>
      <div>
        {% if deep and children.length %}
          <sfgov-icon symbol="chevron-down" role="img" aria-label="arrow pointing down"></sfgov-icon>
        {% endif %}
      </div>
    </a>
    {% if deep %}
      {% if url === '/' %}
        {% set parent_active = page.url === url %}
      {% else %}
        {% set parent_active = page.url.startsWith(url) %}
      {% endif %}
      {% if parent_active %}
        <ul class="m-0 p-0 list-none">
          {% for child in children %}
            {% set child_active = child.url === page.url %}
            <li class="pl-16 m-0 mb-20 {{ 'bg-slate-2 rounded-4' if child_active }}">
              <a
                href="{{ child.url }}"
                {% if child_active %}
                  aria-current="page"
                {% endif %}
                class="block no-underline {{ 'text-white' if child_active else 'text-slate-4' }}"
              >
                {{ child.data.title }}
              </a>
            </li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endif %}
  </div>
{% endmacro %}

{% macro swatch(color, width, height) %}
  <div class="mr-20 mb-20">
    <h4 class="title-xs mt-0 mb-4">
      {{ color.label }}
    </h4>
    {% if color.value or not color.swatches %}
      <code class="block text-slate mb-8">
        {{ color.value | default('???') }}
      </code>
    {% endif %}
    {% if color.swatches %}
      <div class="flex mt-20">
        {% for child in color.swatches %}
          {{ swatch(child, width, height) }}
        {% endfor %}
      </div>
    {% else %}
      <div class="rounded {{ color.class }}"
        style="
          background-color: {{ color.value }};
          width: {{ width | default(100) }}px;
          height: {{ height | default(100) }}px;
        ">
      </div>
    {% endif %}
  </div>
{% endmacro %}

{% macro tooltip(text, attrs) %}
  <div
    {{
      attributes(attrs, {
        class: 'hidden group-hocus:block rounded-4 px-8 py-4 bg-slate-4 text-white text-small font-regular'
      }) | safe
    }}
  >{{ text }}</div>
{% endmacro %}
